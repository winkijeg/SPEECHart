function upperLip = matchUpperLip(obj, ptAttachIncisor, distRatioTeethInsertionPoints)
% connect standard upper lip with incisor with regard to lip size

scaleFactor = 2 ;% min(1, distRatioTeethInsertionPoints * 1.1);

% define upperlip (standard)
upperlipStandard = ...
   [-17.6742 11.5358; ...
    -17.2861 10.0189; ...
    -17.3214  8.2197; ...
    -17.6389  6.8439; ...
    -18.3797  5.1858; ...
    -19.0500  3.9158; ...
    -19.7556  2.2578; ...
    -20.0025  1.2347; ...
    -20.3200 -0.1411; ...
    -20.5669 -1.1994; ...
    -20.1083 -2.3636; ...
    -19.5792 -3.2103; ...
    -18.3444 -4.1981; ...
    -17.3214 -4.4450; ...
    -16.0161 -5.1153; ...
    -14.5697 -5.0800; ...
    -13.1939 -5.3975; ...
    -11.9944 -4.9389; ...
    -10.7950 -4.4803; ...
    -9.5250 -3.6689; ...
    -8.7842 -3.4925; ...
    -7.9375 -2.9633; ...
    -7.5142 -2.6811]';

nPtUpperLip = length(upperlipStandard);
upperlipStandard3D = [zeros(1, nPtUpperLip); upperlipStandard];

% find offset between last lip point and attach point on the incisor

tMat = tmat_init();

% scale
scaleVec = [0 scaleFactor scaleFactor];
t1 = tmat_scale(tMat, scaleVec);
lipTmp = tmat_mxp2(t1, nPtUpperLip, upperlipStandard3D);
% determine neccesary shift to attach upper incisor
translateVec = [0 ptAttachIncisor'] - lipTmp(1:3, nPtUpperLip)';

% translate 
t2 = tmat_trans(t1, translateVec);

% transform all lip points with final transformation matrix
lipTrans = tmat_mxp2(t2, nPtUpperLip, upperlipStandard3D);
upperLip(1:2, :) = lipTrans(2:3, :);

% upperLip =  upperlipStandard + ...
%     repmat(offset, 1, nPtUpperLip);


% upperlip_mri(1,:) = scaleFactor * ...
%     (upperlip_mri(1, :) - upperIncisorPalate(1, 1)) ...
%     + upperIncisorPalate(1,1);
% 
% upperlip_mri(2,:) = scaleFactor * ...
%     (upperlip_mri(2,:) - upperIncisorPalate(2, 1)) ...
%     + upperIncisorPalate(2,1);

end

